faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols =
names_to = "Sample",
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point() +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance, color="green")) +
geom_point() +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance, fill="green")) +
geom_point() +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(fill="green")) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color="green")) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(fill="green")) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(fill="green")) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(mapping = aes(fill="green")) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(fill="green") +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Abundance)) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Functional Pathways Across Samples",
x = "Sample",
y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pahtways for the samples:",x = "Sample",y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t")
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
View(faprotax_out_lagoon)
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 10), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>%
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0)
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 50), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 30), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 20), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
#scale_size(range = c(1, 15), name = "Abundance") +
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
scale_fill_viridis_c(name = "Abundance") +  # Using viridis color palette for better readability
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Rotate x labels for better readability
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
# scale_fill_viridis_c(name = "Abundance") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway") +
theme_minimal()
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway") +
theme_minimal()
library(phyloseq)
library(ggplot2)
library(tidyverse)
sample1 <- read.table("/home/floris/Documenten/Data_set/ACFC_Wastewater_Metagenomics/bracken/in_lagoon_bracken_report.txt", header=FALSE, sep="\t",
col.names=c("percentage", "reads", "reads_added", "rank", "taxid", "name"))
sample2 <- read.table("/home/floris/Documenten/Data_set/ACFC_Wastewater_Metagenomics/bracken/out_lagoon_bracken_report.txt", header=FALSE, sep="\t",
col.names=c("percentage", "reads", "reads_added", "rank", "taxid", "name"))
sample1$name <- trimws(sample1$name)
sample2$name <- trimws(sample2$name)
all_taxa <- unique(c(sample1$name, sample2$name))
counts <- matrix(0, nrow=length(all_taxa), ncol=2)
rownames(counts) <- all_taxa
colnames(counts) <- c("Sample1", "Sample2")
# Fill in counts using reads column
for(i in 1:nrow(sample1)) {
counts[sample1$name[i], "Sample1"] <- sample1$reads[i]
}
for(i in 1:nrow(sample2)) {
counts[sample2$name[i], "Sample2"] <- sample2$reads[i]
}
# Create phyloseq object
OTU <- otu_table(counts, taxa_are_rows=F)
#OTU <- OTU %>% filter(Sample1 > 500)
physeq <- phyloseq(OTU)
# Plot relative abundance
plot_bar(physeq, fill="Sample")
remotes::install_github("fbreitwieser/pavian")
pavian::runApp(port=5000)
pavian::runApp(port=5000, maxUploadSize = (500*1024^2))
knitr::opts_chunk$set(echo = TRUE)
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
View(faprotax_out_lagoon)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
faprotax_in_lagoon <- read.csv2("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", sep = "\t")
faprotax_in_lagoon <- faprotax_in_lagoon %>% filter(in_lagoon > 0)
ggplot(data = faprotax_in_lagoon, mapping = aes(x = group, y = in_lagoon)) +
geom_bar(stat="identity", fill = "blue", alpha=0.5) +
theme(axis.text.x=element_text(angle=45, hjust=1)) +
coord_flip()
faprotax_out_lagoon <- read.csv2("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", sep = "\t")
faprotax_out_lagoon <- faprotax_out_lagoon %>% filter(out_lagoon > 0)
ggplot(data = faprotax_out_lagoon, mapping = aes(x = group, y = out_lagoon)) +
geom_bar(stat="identity", fill = "blue", alpha=0.5) +
theme(axis.text.x=element_text(angle=45, hjust=1)) +
coord_flip()
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway") +
theme_minimal()
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
View(faprotax_out_lagoon)
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
View(faprotax_out_lagoon)
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
R.version.string
packageVersion("tibble")
packageVersion("tidyr")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon))
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon))
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
faprotax_in_lagoon <- read.csv2("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", sep = "\t")
faprotax_in_lagoon <- faprotax_in_lagoon %>% filter(in_lagoon > 0)
ggplot(data = faprotax_in_lagoon, mapping = aes(x = group, y = in_lagoon)) +
geom_bar(stat="identity", fill = "blue", alpha=0.5) +
theme(axis.text.x=element_text(angle=45, hjust=1)) +
coord_flip()
faprotax_out_lagoon <- read.csv2("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", sep = "\t")
faprotax_out_lagoon <- faprotax_out_lagoon %>% filter(out_lagoon > 0)
ggplot(data = faprotax_out_lagoon, mapping = aes(x = group, y = out_lagoon)) +
geom_bar(stat="identity", fill = "blue", alpha=0.5) +
theme(axis.text.x=element_text(angle=45, hjust=1)) +
coord_flip()
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon))
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway") +
theme_minimal()
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon)
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon))
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
knitr::opts_chunk$set(echo = TRUE)
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon))
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
faprotax_in_lagoon <- read.csv2("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", sep = "\t")
faprotax_in_lagoon <- faprotax_in_lagoon %>% filter(in_lagoon > 0)
ggplot(data = faprotax_in_lagoon, mapping = aes(x = group, y = in_lagoon)) +
geom_bar(stat="identity", fill = "blue", alpha=0.5) +
theme(axis.text.x=element_text(angle=45, hjust=1)) +
coord_flip()
faprotax_out_lagoon <- read.csv2("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", sep = "\t")
faprotax_out_lagoon <- faprotax_out_lagoon %>% filter(out_lagoon > 0)
ggplot(data = faprotax_out_lagoon, mapping = aes(x = group, y = out_lagoon)) +
geom_bar(stat="identity", fill = "blue", alpha=0.5) +
theme(axis.text.x=element_text(angle=45, hjust=1)) +
coord_flip()
faprotax_out_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/out_lagoon/out_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
faprotax_in_lagoon <- read.table("~/Documenten/Data_set/ACFC_Wastewater_Metagenomics/faprotax/in_lagoon/in_lagoon_function_table.tsv", header = TRUE, sep = "\t", row.names = 1)
combination_in_out_lagoon <- data.frame(cbind(faprotax_out_lagoon, faprotax_in_lagoon))
data_long <- combination_in_out_lagoon %>% # Make it into long format for the plot.
rownames_to_column("Pathway") %>%
pivot_longer(cols = -Pathway,
names_to = "Sample",
values_to = "Abundance")
data_long <- data_long %>% filter(Abundance > 0) # Filter the 0 values.
ggplot(data_long, aes(x = Sample, y = Pathway, size = Abundance)) +
geom_point(aes(color=Sample)) +
scale_size(range = c(1, 15), name = "Abundance") + # Looks better with scaling...
theme_minimal() +
labs(title = "Amount of pathways for the samples:",x = "Sample",y = "Pathway")
ggplot(data_long, aes(x = Sample, y = Pathway, fill = Abundance)) +
geom_tile() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Amount of pathways for the samples:", x = "Sample", y = "Pathway") +
theme_minimal()
search()
R
version
colnames <- c("Group")
coldata <- data.frame(c("In_Lagoon", "Out_Lagoon"), c("In_Lagoon","Out_Lagoon"), row.names = 1)
colnames(coldata) <- colnames
coldata$Group <- factor(coldata$Group)
dds <- DESeqDataSetFromMatrix(countData = counts_df,
colData = coldata,
design= ~ Group)
View(coldata)
View(coldata)
